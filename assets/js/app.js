define("data/files",function(a,b,c){var d=[{id:0,name:"images",path:"images",covers:[],children:[{id:1,name:"3DXS",path:"images/3DXS",pid:0,covers:[],children:[{id:2,name:"ABC",path:"images/3DXS/ABC",pid:1,covers:["test1.txt","test2.txt"]},{id:3,name:"XYZ",path:"images/3DXS/XYZ",pid:1,covers:["test4 - 副本 (2).jpg","test4 - 副本.jpg","test4.jpg","test411这是埃杜阿多阿斯顿撒 - 副本 (2).jpg","test411这是埃杜阿多阿斯顿撒 - 副本.jpg","test411这是埃杜阿多阿斯顿撒.jpg","test5 - 副本 (2).jpg","test5 - 副本.jpg","test5.jpg","test6 - 副本 (2).jpg","test6 - 副本.jpg","test6.jpg","这是阿迪斯AADD但是的撒大大 - 副本 (2).png","这是阿迪斯AADD但是的撒大大 - 副本.png","这是阿迪斯AADD但是的撒大大.png","阿达阿达萨达aa - 副本 (2).jpg","阿达阿达萨达aa - 副本.jpg","阿达阿达萨达aa.jpg"]}]},{id:4,name:"JLB",path:"images/JLB",pid:0,covers:[],children:[{id:5,name:"2013",path:"images/JLB/2013",pid:4,covers:[],children:[{id:6,name:"201301",path:"images/JLB/2013/201301",pid:5,covers:["SSS.txt"]},{id:7,name:"201308",path:"images/JLB/2013/201308",pid:5,covers:["SSS - 副本 (2).txt","SSS - 副本 (3).txt","SSS - 副本.txt","SSS.txt","SSS2 - 副本 (2).txt","SSS2 - 副本 (3).txt","SSS2 - 副本.txt","SSS2.txt"]}]},{id:8,name:"2014",path:"images/JLB/2014",pid:4,covers:[],children:[{id:9,name:"201401",path:"images/JLB/2014/201401",pid:8,covers:["SSS.txt"]},{id:10,name:"201402",path:"images/JLB/2014/201402",pid:8,covers:["SSS - 副本 (2).txt","SSS - 副本 (3).txt","SSS - 副本.txt","SSS.txt","SSS2 - 副本 (2).txt","SSS2 - 副本 (3).txt","SSS2 - 副本.txt","SSS2.txt"]}]},{id:11,name:"2015",path:"images/JLB/2015",pid:4,covers:["test1.png","test2.png"],children:[{id:12,name:"201501",path:"images/JLB/2015/201501",pid:11,covers:["SSS.txt"]},{id:13,name:"201508",path:"images/JLB/2015/201508",pid:11,covers:["SSS - 副本 (2).txt","SSS - 副本 (3).txt","SSS - 副本.txt","SSS.txt","SSS2 - 副本 (2).txt","SSS2 - 副本 (3).txt","SSS2 - 副本.txt","SSS2.txt"]}]}]},{id:14,name:"One",path:"images/One",pid:0,covers:[],children:[{id:15,name:"201301",path:"images/One/201301",pid:14,covers:["ada.txt","adadddd.txt"]},{id:16,name:"201501",path:"images/One/201501",pid:14,covers:[]}]}]}];c.exports=d}),define("widget/menu",function(a,b,c){var d=a("data/files"),e=Backbone.View.extend({className:"w_menu",events:{"click li":function(a){var b=$(a.currentTarget);return b.hasClass("active")?this.unActive(b):this.beActive(b),!1},"click li.end-li":function(a){var b=$(a.currentTarget),c=b.find(">a").data("path");return location.hash=c,!1}},beActive:function(a){this.unActive(a.siblings("li.active")),a.find(">ul").slideDown("fast",function(){a.addClass("active")}),this.$el.find("a.selected").removeClass("selected"),a.children("a").addClass("selected")},unActive:function(a){return a.hasClass("end-li")?!1:void a.find(">ul").slideUp("fast",function(){a.removeClass("active")})},getActiveLi:function(){var a={},b=this.$el.find(".end-li>a.selected");return a.path=b.data("path"),a.files=b.data("files"),a},initialize:function(a,b){var c=$("#tpl_menu").html(),e=_.template(c)({menu:d[0]}),f=this.$el.html(e);$(".sidemenu .bottom").html(f)}});c.exports=e}),define("app",function(a,b,c){var d,e={},f=a("widget/menu"),g=Backbone.Model.extend({defaults:{boxWidth:d,boxHeight:d,imgs:d,total:d,lastIndex:d,cols:d,colWidth:d},calcCols:function(){var a=this.get("boxWidth"),b=Math.floor(a/250);0==b&&(b=1),this.set("cols",b)},calColWidth:function(){var a=(this.get("boxWidth"),this.get("cols")),b=Math.floor(100/a);this.set("colWidth",b)},calColTotal:function(){var a=this.get("imgs");this.set("total",a.length)},initialize:function(){this.on("change:boxWidth",this.calcCols),this.on("change:cols",this.calColWidth),this.on("change:imgs",this.calColTotal)}}),h=Backbone.View.extend({el:document.body,events:{"click .p_header .totals":function(a){var b=$(a.currentTarget),c=b.find(".js-totals").html();if("0"!==c){var d=b.hasClass("active");d?(b.removeClass("active"),this.filterOff()):(b.addClass("active"),this.filterOn())}},"click .p_totals>span":function(a){var b=$(a.currentTarget);b.siblings("span").removeClass("active"),b.addClass("active");var c=$.trim(b.html());$(".img-box").each(function(a,b){var d=$(this).find("a");return d.attr("title")==c?($(".img-box").removeClass("active"),$(this).addClass("active"),!1):void 0}),this.scollActive(),$(".p_header .totals").trigger("click")},"click .p_menu_btn":function(a){var b=$(a.currentTarget);b.hasClass("active")?this.menuOff():this.menuOn()}},menuOff:function(){$(".p_menu_btn").removeClass("active"),$(".p_left").removeClass("active"),$(".p_header").removeClass("active"),$(".p_right").removeClass("active"),$(".p_totals").removeClass("menu-active")},menuOn:function(){$(".p_menu_btn").addClass("active"),$(".p_left").addClass("active"),$(".p_header").addClass("active"),$(".p_right").addClass("active"),$(".p_totals").addClass("menu-active")},filterOff:function(){$(".p_totals").slideUp("fast",function(){$(this).removeClass("active")})},filterOn:function(){$(".p_totals").slideDown("fast",function(){$(this).addClass("active")})},minHeightCol:function(){var a=$(".water-fall:eq(0)"),b=a.height();return $(".water-fall").each(function(c,d){var e=$(this),f=e.height();b>f&&(b=f,a=e)}),a},appendImg:function(a){for(var b=this,c=(this.model.get("lastIndex"),this.model.get("cols"),this.model.get("imgs")),d=$("#tpl_img_simgle").html(),e=0;e<c.length;e++){var f=new Image;f.src=a+"/"+c[e],f.title=c[e],f.onload=function(){var c=b.minHeightCol(),e=(this.src,this.title),f=_.template(d)({path:a,name:e});c.append(f)}}},calBoxWidth:function(){var a=this.$el.find(".p_right").width();this.model.set("boxWidth",a);var b=this.$el.find(".p_right").height();this.model.set("boxHeight",b)},randerRight:function(){for(var a=this.model.get("cols"),b=this.model.get("colWidth"),c="",d='<div class="water-fall" style="width:'+b+'%"></div>',e=0;a>e;e++)c+=d;this.$el.find(".p_right").html(c);var f=this.menu.getActiveLi(),g=f.path,h=f.files;if(!g||!h)return!1;h=h.split(","),this.model.set("imgs",h),this.model.set("lastIndex",0),this.appendImg(g);var i=g.replace("images/","");this.$el.find(".p_header .crumbs>span").html(i.replace("/"," / "));var j="";_.each(h,function(a){j+="<span>"+a+"</span>"}),this.$el.find(".p_totals").html($.trim(j)),$(".p_header .totals .js-totals").html(h.length)},scollActive:function(){var a=$(".img-box.active"),b=a.offset().top,c=$(".p_right").scrollTop();$(".p_right").animate({scrollTop:b+c-40},400)},resetPage:function(){this.$el.find(".p_header .totals").removeClass("active"),this.filterOff()},initialize:function(a,b){var c=this;this.menu=new f,this.model=new g,c.calBoxWidth(),this.model.on("change:boxWidth",c.randerRight,c),$(".p_left").niceScroll({cursorcolor:"rgba(122,122,122,0.6)",cursorborder:"0"}),$(".p_right").niceScroll({cursorcolor:"rgba(122,122,122,0.6)",cursorborder:"0"}),$(".p_totals").niceScroll({cursorcolor:"rgba(122,122,122,0.6)",cursorborder:"0"})}}),i=Backbone.Router.extend({routes:{"images/*param":"randerRight"},randerRight:function(){e.mainView.resetPage(),e.mainView.randerRight()}});e.mainView=new h,e.mainRouter=new i,Backbone.history.start(),c.exports=e});